<!DOCTYPE html>
<html>
<head>
	<title>Ok I'm here now what</title>
	<script src="https://www.amcharts.com/lib/4/core.js"></script>
	<script src="https://www.amcharts.com/lib/4/maps.js"></script>
	<script src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/t-160/waSchools.js"></script>
	<script src="https://www.amcharts.com/lib/4/geodata/worldLow.js"></script>
	<style type="text/css">
		* {
			padding: 0;
			margin: 0;
		}
		body,html{
			height: 100%;
			width: 100%;
		}
		#chartdiv {
		  width: 100%;
		  height: 98vh;
		}
	</style>
</head>
<body>
	<h1>Please work</h1>
	<button onclick="getColors(printResponse)">Asia</button>
	<p id="colors"></p>
	<div id="chartdiv"></div>
	<script type="text/javascript">
		function getColors(callback) {
			var xmlHttp = new XMLHttpRequest();
	        xmlHttp.onreadystatechange = function() { 
	            if (xmlHttp.readyState == 4 && xmlHttp.status == 200)
	                callback(xmlHttp.responseText);
	        }
	        xmlHttp.open("GET", "https://salty-cliffs-12768.herokuapp.com/color", true); // true for asynchronous 
	        xmlHttp.send(null);
		}
		function printResponse(response) {
			var myText = JSON.parse(response);
			var chart = am4core.create("chartdiv", am4maps.MapChart);

			// Set map definition
			chart.geodata = am4geodata_worldLow;
			// Set projection
			chart.projection = new am4maps.projections.Miller();	
			// Create map polygon series
			var polygonSeries = chart.series.push(new am4maps.MapPolygonSeries());

			// Make map load polygon (like country names) data from GeoJSON
			polygonSeries.include = myText["alpha2Code"];
			polygonSeries.useGeodata = true;

			// Configure series
			var polygonTemplate = polygonSeries.mapPolygons.template;
			polygonTemplate.tooltipText = "{name}";
			polygonTemplate.fill = am4core.color("#74B266");

			// Create hover state and set alternative fill color
			var hs = polygonTemplate.states.create("hover");
			hs.properties.fill = am4core.color("#367B25");

			// Add zoom control
			chart.zoomControl = new am4maps.ZoomControl();
			polygonSeries.data = []
			for(var i = 0;i < myText.countries.length;i++) {
				polygonSeries.data.push({
					"id": myText["alpha2Code"][i],
					"name": myText.countries[i],
					"value": 50,
					"fill": am4core.color(myText.colors[i])
				})
			}
			polygonTemplate.propertyFields.fill = "fill";
		}
	</script>
</body>
</html>